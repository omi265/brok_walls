<Window x:Class="NasaWallpaperApp.EditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Adjust Wallpaper" Height="650" Width="950"
        WindowStyle="None" ResizeMode="NoResize" AllowsTransparency="True"
        Background="Transparent" WindowStartupLocation="CenterScreen" FontFamily="Segoe UI">

    <Border CornerRadius="10" Background="{StaticResource BgDark}" BorderBrush="#333" BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/> <!-- Title Bar -->
                <RowDefinition Height="*"/>  <!-- Canvas -->
                <RowDefinition Height="80"/> <!-- Controls -->
            </Grid.RowDefinitions>

            <!-- TITLE BAR -->
            <Border Grid.Row="0" Background="Transparent" MouseDown="TitleBar_MouseDown">
                <Grid>
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="15,0,0,0">
                        <TextBlock Text="ADJUST" FontWeight="Bold" Foreground="{StaticResource AccentColor}" FontSize="12"/>
                        <TextBlock Text=" &amp; CROP" FontWeight="SemiBold" Foreground="{StaticResource TextSecondary}" FontSize="12"/>
                    </StackPanel>
                    <Button Content="X" Click="Cancel_Click" Style="{StaticResource IconBtn}" HorizontalAlignment="Right" Width="40" Margin="0,0,5,0" Foreground="White"/>
                </Grid>
            </Border>

            <!-- PREVIEW AREA -->
            <Border Grid.Row="1" Margin="20,0,20,0" ClipToBounds="True" Background="#111" CornerRadius="8" BorderBrush="#333" BorderThickness="1">
                <Viewbox>
                    <Canvas Name="ScreenCanvas" Width="1920" Height="1080" Background="#050505"
                            MouseLeftButtonDown="Canvas_MouseDown"
                            MouseLeftButtonUp="Canvas_MouseUp"
                            MouseMove="Canvas_MouseMove"
                            MouseWheel="Canvas_MouseWheel">
                        
                        <Canvas.RenderTransform>
                             <TranslateTransform x:Name="CanvasTranslate"/>
                        </Canvas.RenderTransform>

                        <Image Name="EditImage" Stretch="Uniform"
                               RenderTransformOrigin="0.5,0.5">
                            <Image.RenderTransform>
                                <TransformGroup>
                                    <RotateTransform x:Name="ImgRotate"/>
                                    <ScaleTransform x:Name="ImgScale"/>
                                    <TranslateTransform x:Name="ImgTranslate"/>
                                </TransformGroup>
                            </Image.RenderTransform>
                        </Image>
                        
                        <!-- Center Guidelines (Visual Feedback) -->
                        <Line X1="0" Y1="540" X2="1920" Y2="540" Stroke="#4CC2FF" StrokeThickness="2" Opacity="0" Name="GuideH"/>
                        <Line X1="960" Y1="0" X2="960" Y2="1080" Stroke="#4CC2FF" StrokeThickness="2" Opacity="0" Name="GuideV"/>
                    </Canvas>
                </Viewbox>
            </Border>

            <!-- CONTROLS -->
            <Border Grid.Row="2" Background="Transparent" Padding="20,0">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/> <!-- Tools -->
                        <ColumnDefinition Width="*"/>    <!-- Zoom -->
                        <ColumnDefinition Width="Auto"/> <!-- Actions -->
                    </Grid.ColumnDefinitions>

                    <!-- TOOLS -->
                    <StackPanel Orientation="Horizontal" Grid.Column="0" VerticalAlignment="Center">
                        <Button Content="↺" Click="RotateLeft_Click" Style="{StaticResource ModernBtn}" Width="40" Height="40" FontSize="18" Padding="0" Margin="0,0,5,0" ToolTip="Rotate Left"/>
                        <Button Content="↻" Click="RotateRight_Click" Style="{StaticResource ModernBtn}" Width="40" Height="40" FontSize="18" Padding="0" Margin="0,0,15,0" ToolTip="Rotate Right"/>
                        
                        <Button Content="Fit" Click="Fit_Click" Style="{StaticResource ModernBtn}" Height="40" Margin="0,0,5,0" FontSize="12"/>
                        <Button Content="Fill" Click="Fill_Click" Style="{StaticResource ModernBtn}" Height="40" FontSize="12"/>
                    </StackPanel>

                    <!-- ZOOM -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="ZOOM" Foreground="#666" FontWeight="Bold" FontSize="10" VerticalAlignment="Center" Margin="0,0,15,0"/>
                        <Slider Name="ZoomSlider" Width="200" Minimum="0.1" Maximum="3.0" Value="1.0" VerticalAlignment="Center" ValueChanged="ZoomSlider_ValueChanged"/>
                    </StackPanel>

                    <!-- ACTIONS -->
                    <StackPanel Orientation="Horizontal" Grid.Column="2" VerticalAlignment="Center">
                        <Button Content="Cancel" Click="Cancel_Click" Style="{StaticResource ModernBtn}" Background="Transparent" Foreground="#AAA" Margin="0,0,10,0"/>
                        <Button Content="Set Wallpaper" Click="Save_Click" Style="{StaticResource AccentBtn}" Height="40" Padding="20,0"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- OVERLAY INSTRUCTIONS -->
            <TextBlock Grid.Row="1" Text="Scroll to Zoom • Drag to Snap" Foreground="White" Opacity="0.3" 
                       VerticalAlignment="Top" HorizontalAlignment="Center" Margin="0,15,0,0" IsHitTestVisible="False"/>
        </Grid>
    </Border>
</Window>